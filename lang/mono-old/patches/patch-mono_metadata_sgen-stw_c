$OpenBSD$

DEBUG printf's

Index: mono/metadata/sgen-stw.c
--- mono/metadata/sgen-stw.c.orig
+++ mono/metadata/sgen-stw.c
@@ -62,6 +62,7 @@ static void
 update_current_thread_stack (void *start)
 {
 	int stack_guard = 0;
+	printf("calling mono_thread_info_current from function update_current_thread_stack in sgen-stw.c\n");
 	SgenThreadInfo *info = mono_thread_info_current ();
 
 	info->client_info.stack_start = align_pointer (&stack_guard);
@@ -118,6 +119,7 @@ sgen_client_stop_world (int generation)
 	update_current_thread_stack (&generation);
 
 	sgen_global_stop_count++;
+	printf("calling mono_thread_info_current from function sgen_client_stop_world in sgen-stw.c\n");
 	SGEN_LOG (3, "stopping world n %d from %p %p", sgen_global_stop_count, mono_thread_info_current (), (gpointer) (gsize) mono_native_thread_id_get ());
 	TV_GETTIME (stop_world_time);
 
@@ -222,6 +224,7 @@ sgen_is_thread_in_current_stw (SgenThreadInfo *info, i
 	/*
 	Suspending the current thread will deadlock us, bad idea.
 	*/
+	printf("calling mono_thread_info_current from function sgen_is_thread_in_current_stw in sgen-stw.c\n");
 	if (info == mono_thread_info_current ()) {
 		if (reason)
 			*reason = 3;
@@ -257,6 +260,7 @@ sgen_unified_suspend_stop_world (void)
 	int sleep_duration = -1;
 
 	mono_threads_begin_global_suspend ();
+	printf("calling mono_thread_info_current from function sgen_unified_suspend_stop_world(1) in sgen-stw.c\n");
 	THREADS_STW_DEBUG ("[GC-STW-BEGIN][%p] *** BEGIN SUSPEND *** \n", mono_thread_info_get_tid (mono_thread_info_current ()));
 
 	FOREACH_THREAD (info) {
@@ -274,6 +278,7 @@ sgen_unified_suspend_stop_world (void)
 		THREADS_STW_DEBUG ("[GC-STW-BEGIN-SUSPEND] SUSPEND thread %p skip %s\n", mono_thread_info_get_tid (info), info->client_info.skip ? "true" : "false");
 	} FOREACH_THREAD_END
 
+	printf("calling mono_thread_info_current from function sgen_unified_suspend_stop_world(2) in sgen-stw.c\n");
 	mono_thread_info_current ()->client_info.suspend_done = TRUE;
 	mono_threads_wait_pending_operations ();
 
@@ -351,6 +356,7 @@ sgen_unified_suspend_stop_world (void)
 
 		int reason = 0;
 		if (!sgen_is_thread_in_current_stw (info, &reason)) {
+			printf("calling mono_thread_info_current from function sgen_unified_suspend_stop_world(3) in sgen-stw.c\n");
 			g_assert (!info->client_info.suspend_done || info == mono_thread_info_current ());
 
 			THREADS_STW_DEBUG ("[GC-STW-SUSPEND-END] thread %p is NOT suspended, reason %d\n", mono_thread_info_get_tid (info), reason);
